const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./search-DqECxRmk.js","./index-Bx7rElEd.js","./@vue-_BCsYqm-.js","./element-plus-CoQd9HEf.js","./lodash-es-DCh--ulG.js","./@vueuse-DKZ1O7gq.js","./@element-plus-DpD46RjY.js","./@sxzz-CpAfbxx4.js","./@ctrl-D2oWfImC.js","./dayjs-Cud5yAXI.js","./async-validator-BTKOuuO-.js","./memoize-one-Ds0C_khL.js","./normalize-wheel-es-Vn5vHDCm.js","./@floating-ui-DT7V1Oc1.js","../css/element-plus-B3lJtvYm.css","./crypto-js-BfYQ37JU.js","./axios-DMXdiZgf.js","./vue-router-DP39kmEB.js","./nprogress-BX4rmQ7W.js","../css/nprogress-BgDCIyLK.css","./vuex-CNGLPxA3.js","./json-bigint-D0bu8vFr.js","./bignumber.js-iDjSUVmj.js","./vue-i18n-DbMEmpqT.js","./@intlify-CZIS8eQd.js","./vue3-json-viewer-B-aZDOpp.js","../css/vue3-json-viewer-ByH33Jf7.css","./ace-builds-D9YH2WY7.js","./vue3-ace-editor-ubj-WOyx.js","./resize-observer-polyfill-CzGuHLZU.js","./sortablejs-BALiOaUQ.js","./vkbeautify-DEVEMlla.js","../css/index-CllpfDYF.css","../css/search-DPwE4JnJ.css","./tasks-DyTFxKxD.js","../css/tasks-BO47l7QR.css","./list-RDy1KBWe.js","../css/list-cNCWp5cC.css"])))=>i.map(i=>d[i]);
import{o as e,c as t,S as i,O as s,R as a,a7 as l,J as n,K as o,a as r,Q as u,Y as d,M as c,aj as m,L as h,at as p,ap as f,P as g,E as v,F as y,G as b,U as _,aE as k,T as $,aF as C}from"./@vue-_BCsYqm-.js";import{_ as w,D as T,f as x,a as M}from"./index-Bx7rElEd.js";import{_ as E}from"./logo-BrD2dTrf.js";import{S as I}from"./sortablejs-BALiOaUQ.js";import"./element-plus-CoQd9HEf.js";import"./lodash-es-DCh--ulG.js";import"./@vueuse-DKZ1O7gq.js";import"./@element-plus-DpD46RjY.js";import"./@sxzz-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Cud5yAXI.js";import"./async-validator-BTKOuuO-.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./crypto-js-BfYQ37JU.js";import"./axios-DMXdiZgf.js";import"./vue-router-DP39kmEB.js";import"./nprogress-BX4rmQ7W.js";import"./vuex-CNGLPxA3.js";import"./json-bigint-D0bu8vFr.js";import"./bignumber.js-iDjSUVmj.js";import"./vue-i18n-DbMEmpqT.js";import"./@intlify-CZIS8eQd.js";import"./vue3-json-viewer-B-aZDOpp.js";import"./ace-builds-D9YH2WY7.js";import"./vue3-ace-editor-ubj-WOyx.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./vkbeautify-DEVEMlla.js";const L={key:0,style:{padding:"20px"}},P=["href"],O={key:0,class:"menu-tag"},A={key:1,class:"menu-tag"};const V=w({name:"NavMenu",props:["navMenus"],data:()=>({}),methods:{hasChildren:e=>e.children&&!e.children.every((e=>e.meta.hidden))}},[["render",function(h,p,f,g,v,y){const b=m("el-alert"),_=m("el-icon"),k=m("el-menu-item"),$=m("NavMenu",!0),C=m("el-sub-menu");return e(),t(a,null,[f.navMenus.length<=0?(e(),t("div",L,[i(b,{closable:!1,title:h.$t("无子集菜单"),center:"",type:"info"},null,8,["title"])])):s("",!0),(e(!0),t(a,null,l(f.navMenus,(l=>(e(),t(a,{key:l},[y.hasChildren(l)?(e(),n(C,{key:1,index:l.path},{title:o((()=>[l.meta&&l.meta.icon?(e(),n(_,{key:0},{default:o((()=>[(e(),n(c(l.meta.icon||"el-icon-menu")))])),_:2},1024)):s("",!0),r("span",null,u(l.meta.title),1),l.meta.tag?(e(),t("span",A,u(l.meta.tag),1)):s("",!0)])),default:o((()=>[i($,{navMenus:l.children},null,8,["navMenus"])])),_:2},1032,["index"])):(e(),n(k,{key:0,index:l.path},{title:o((()=>[r("span",null,u(l.meta.title),1),l.meta.tag?(e(),t("span",O,u(l.meta.tag),1)):s("",!0)])),default:o((()=>[l.meta&&"link"===l.meta.type?(e(),t("a",{key:0,href:l.path,onClick:d((()=>{}),["stop"]),target:"_blank"},null,8,P)):s("",!0),l.meta&&l.meta.icon?(e(),n(_,{key:1},{default:o((()=>[(e(),n(c(l.meta.icon||"el-icon-menu")))])),_:2},1024)):s("",!0)])),_:2},1032,["index"]))],64)))),128))],64)}]]),N={class:"logo-bar"};const j=w({components:{NavMenu:V},data:()=>({nav:!1,menu:[]}),computed:{DEFAULT_CONFIG:()=>T},created(){const e=this.$router.sc_getMenu();this.menu=this.filterUrl(e)},watch:{},methods:{showMobileNav(e){if("true"===e.currentTarget.getAttribute("drag-flag"))return!1;this.nav=!0},select(){this.$refs.mobileNavBox.handleClose()},filterUrl(e){const t=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"===e.meta.type)return!1;"iframe"===e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=this.filterUrl(e.children)),t.push(e)})),t}},directives:{drag(e){let t=e,i="",s="";t.onmousedown=function(e){let a=e.clientX-t.offsetLeft,l=e.clientY-t.offsetTop;return document.onmousemove=function(e){t.setAttribute("drag-flag",!0),i=(new Date).getTime();let s=e.clientX-a,n=e.clientY-l;n>0&&n<document.body.clientHeight-50&&(t.style.top=n+"px"),s>0&&s<document.body.clientWidth-50&&(t.style.left=s+"px")},document.onmouseup=function(){s=(new Date).getTime(),s-i>200&&t.setAttribute("drag-flag",!1),document.onmousemove=null,document.onmouseup=null},!1}}}},[["render",function(s,l,n,d,c,f){const g=m("el-icon-menu"),v=m("el-icon"),y=m("el-header"),b=m("NavMenu"),_=m("el-menu"),k=m("el-scrollbar"),$=m("el-main"),C=m("el-container"),w=m("el-drawer"),T=p("drag");return e(),t(a,null,[h((e(),t("div",{onClick:l[0]||(l[0]=e=>f.showMobileNav(e)),class:"mobile-nav-button",draggable:"false"},[i(v,null,{default:o((()=>[i(g)])),_:1})])),[[T]]),i(w,{modelValue:c.nav,"onUpdate:modelValue":l[1]||(l[1]=e=>c.nav=e),size:240,title:s.$t("移动端菜单"),"with-header":!1,"destroy-on-close":"",direction:"ltr",ref:"mobileNavBox"},{default:o((()=>[i(C,{class:"mobile-nav"},{default:o((()=>[i(y,null,{default:o((()=>[r("div",N,[l[2]||(l[2]=r("img",{class:"logo logo-fill-color",src:E},null,-1)),r("span",null,u(s.$CONFIG.APP_NAME),1)])])),_:1}),i($,null,{default:o((()=>[i(k,null,{default:o((()=>[i(_,{"default-active":s.$route.meta.active||s.$route.fullPath,onSelect:f.select,router:""},{default:o((()=>[i(b,{navMenus:c.menu},null,8,["navMenus"])])),_:1},8,["default-active","onSelect"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","title"])],64)}],["__scopeId","data-v-83e8e262"]]),S={class:"adminui-topbar"},D={class:"left-panel"},U={class:"right-panel"};const F=w({data:()=>({breadList:[]}),created(){this.getBreadcrumb()},watch:{$route(){this.getBreadcrumb()}},methods:{getBreadcrumb(){this.breadList=this.$route.meta.breadcrumb}}},[["render",function(d,h,p,y,b,_){const k=m("el-icon"),$=m("el-breadcrumb-item"),C=m("el-breadcrumb");return e(),t("div",S,[r("div",D,[i(C,{class:"hidden-sm-and-down","separator-icon":"el-icon-arrow-right"},{default:o((()=>[i(f,{name:"breadcrumb"},{default:o((()=>[(e(!0),t(a,null,l(b.breadList,(i=>(e(),t(a,{key:i.title},["/"===i.path||i.meta.hiddenBreadcrumb?s("",!0):(e(),n($,{key:i.meta.title},{default:o((()=>[i.meta.icon?(e(),n(k,{key:0,class:"icon"},{default:o((()=>[(e(),n(c(i.meta.icon)))])),_:2},1024)):s("",!0),g(" "+u(i.meta.title),1)])),_:2},1024))],64)))),128))])),_:1})])),_:1})]),h[0]||(h[0]=r("div",{class:"center-panel"},null,-1)),r("div",U,[v(d.$slots,"default",{},void 0,!0)])])}],["__scopeId","data-v-fbd8b430"]]),z={class:"adminui-tags"},G={ref:"tags"},B=["onContextmenu"];const R=w({name:"tags",data(){return{refreshTimer:null,contextMenuVisible:!1,contextMenuItem:null,left:0,top:0,tagList:this.$store.state.viewTags.viewTags,tipDisplayed:!1}},props:{vue:{type:Object}},watch:{$route(e){this.addViewTags(e),this.$nextTick((()=>{const e=this.$refs.tags;if(e&&e.scrollWidth>e.clientWidth){e.querySelector(".active").scrollIntoView(),this.tipDisplayed||(this.$msgbox({type:"warning",center:!0,title:"提示",message:"当前标签数量过多，可通过鼠标滚轴滚动标签栏。关闭标签数量可减少系统性能消耗。",confirmButtonText:"知道了"}),this.tipDisplayed=!0)}}))},contextMenuVisible(e){const t=e=>{const t=document.getElementById("contextmenu");t&&!t.contains(e.target)&&this.closeMenu()};e?document.body.addEventListener("click",(e=>t(e))):document.body.removeEventListener("click",(e=>t(e)))}},created(){const e=this.$router.sc_getMenu(),t=this.treeFind(e,(e=>e.path===this.$CONFIG.DASHBOARD_URL));t&&(t.fullPath=t.path,this.addViewTags(t),this.addViewTags(this.$route))},mounted(){this.tagDrop(),this.scrollInit()},methods:{treeFind(e,t){for(const i of e){if(t(i))return i;if(i.children){const e=this.treeFind(i.children,t);if(e)return e}}return null},tagDrop(){const e=this.$refs.tags;I.create(e,{draggable:"li",animation:300})},addViewTags(e){e.name&&!e.meta.fullpage&&(this.$store.commit("pushViewTags",e),this.$store.commit("pushKeepLive",e.name))},isActive(e){return e.fullPath===this.$route.fullPath},closeSelectedTag(e,t=!0){const i=this.tagList.findIndex((t=>t.fullPath===e.fullPath));if(this.$store.commit("removeViewTags",e),this.$store.commit("removeIframeList",e),this.$store.commit("removeKeepLive",e.name),t&&this.isActive(e)){const e=this.tagList[i-1];e?this.$router.push(e):this.$router.push("/")}},openContextMenu(e,t){this.contextMenuItem=t,this.contextMenuVisible=!0,this.left=e.clientX+1,this.top=e.clientY+1,this.$nextTick((()=>{let t=document.getElementById("contextmenu");document.body.offsetWidth-e.clientX<t.offsetWidth&&(this.left=document.body.offsetWidth-t.offsetWidth+1,this.top=e.clientY+1)}))},closeMenu(){this.contextMenuItem=null,this.contextMenuVisible=!1},async scheduledRefresh(){this.closeMenu();try{const e=await this.$prompt("刷新时间间隔（秒）","定时刷新",{inputPattern:/^[1-9]\d*$/,inputErrorMessage:"时间必须为数字",inputValue:"10"}),t=parseInt(e.value);this.$message({showClose:!0,onClose:()=>clearInterval(this.refreshTimer),type:"warning",customClass:"refreshTimer",message:this.$t("{s} 秒后刷新...",{s:t}),duration:0}),this.refreshTimer=setInterval((()=>{const e=document.getElementsByClassName("refreshTimer")[0].getElementsByClassName("el-message__content")[0];let i=parseInt(/(\d+)/.exec(e.innerHTML)[0]);1===i&&(this.vue.routerViewKey=Math.random(),i=t+1),e.innerHTML=e.innerHTML.replace(/\d+/,(i-1).toString())}),1e3)}catch{}},refreshTab(){this.closeMenu(),this.vue.routerViewKey=Math.random()},closeTabs(){const e=this.contextMenuItem;e.meta.affix||(this.closeSelectedTag(e),this.contextMenuVisible=!1)},closeOtherTabs(){const e=this.contextMenuItem;this.$route.fullPath!==e.fullPath&&this.$router.push({path:e.fullPath,query:e.query});[...this.tagList].forEach((t=>{if(t.meta&&t.meta.affix||e.fullPath===t.fullPath)return!0;this.closeSelectedTag(t,!1)})),this.contextMenuVisible=!1},maximize(){const e=this.contextMenuItem;this.contextMenuVisible=!1,this.$route.fullPath!==e.fullPath&&this.$router.push({path:e.fullPath,query:e.query}),document.getElementById("app").classList.add("main-maximize")},openWindow(){const e=this.contextMenuItem,t=e.href||"/";e.meta.affix||this.closeSelectedTag(e),window.open(t),this.contextMenuVisible=!1},scrollInit(){const e=this.$refs.tags;function t(t){const i=t.wheelDelta||t.detail;let s;s=3===i||i<0&&-3!==i?50:-50,e.scrollLeft+=s}e.addEventListener("mousewheel",t,!1)||e.addEventListener("DOMMouseScroll",t,!1)}}},[["render",function(c,h,p,f,v,k){const $=m("el-icon-close"),C=m("el-icon"),w=m("router-link"),T=m("el-icon-refresh"),x=m("el-icon-alarm-clock"),M=m("el-icon-folder-delete"),E=m("el-icon-full-screen"),I=m("el-icon-copy-document");return e(),t(a,null,[r("div",z,[r("ul",G,[(e(!0),t(a,null,l(v.tagList,(a=>(e(),t("li",{key:a,class:y([k.isActive(a)?"active":"",a.meta.affix?"affix":""]),onContextmenu:d((e=>k.openContextMenu(e,a)),["prevent"])},[i(w,{to:a},{default:o((()=>[r("span",null,u(a.meta.title),1),a.meta.affix?s("",!0):(e(),n(C,{key:0,onClick:d((e=>k.closeSelectedTag(a)),["prevent","stop"])},{default:o((()=>[i($)])),_:2},1032,["onClick"]))])),_:2},1032,["to"])],42,B)))),128))],512)]),i(_,{name:"el-zoom-in-top"},{default:o((()=>[v.contextMenuVisible?(e(),t("ul",{key:0,style:b({left:v.left+"px",top:v.top+"px"}),class:"contextmenu",id:"contextmenu"},[r("li",{onClick:h[0]||(h[0]=e=>k.refreshTab())},[i(C,null,{default:o((()=>[i(T)])),_:1}),h[6]||(h[6]=g(" 刷新 "))]),r("li",{onClick:h[1]||(h[1]=e=>k.scheduledRefresh())},[i(C,null,{default:o((()=>[i(x)])),_:1}),h[7]||(h[7]=g(" 定时刷新 "))]),h[12]||(h[12]=r("hr",null,null,-1)),r("li",{class:y(v.contextMenuItem.meta.affix?"disabled":""),onClick:h[2]||(h[2]=e=>k.closeTabs())},[i(C,null,{default:o((()=>[i($)])),_:1}),h[8]||(h[8]=g(" 关闭标签 "))],2),r("li",{onClick:h[3]||(h[3]=e=>k.closeOtherTabs())},[i(C,null,{default:o((()=>[i(M)])),_:1}),h[9]||(h[9]=g(" 关闭其他标签 "))]),h[13]||(h[13]=r("hr",null,null,-1)),r("li",{onClick:h[4]||(h[4]=e=>k.maximize())},[i(C,null,{default:o((()=>[i(E)])),_:1}),h[10]||(h[10]=g(" 最大化 "))]),r("li",{onClick:h[5]||(h[5]=e=>k.openWindow())},[i(C,null,{default:o((()=>[i(I)])),_:1}),h[11]||(h[11]=g(" 在新的窗口中打开 "))])],4)):s("",!0)])),_:1})],64)}]]),K=k((()=>M((()=>import("./search-DqECxRmk.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33]),import.meta.url))),q=k((()=>M((()=>import("./tasks-DyTFxKxD.js")),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,35]),import.meta.url))),J=k((()=>M((()=>import("./list-RDy1KBWe.js")),__vite__mapDeps([36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,37]),import.meta.url))),W={class:"user-bar"},H={class:"user-avatar user-center"};const X={class:"iframe-pages"},Q=["src"];const Y={class:"adminui-header"},Z={class:"logo-bar"},ee={class:"version color-secondary"},te={key:0,class:"nav"},ie=["onClick"],se={class:"adminui-header-right"},ae={class:"aminui-wrapper"},le={key:0,class:"adminui-side-top"},ne={class:"adminui-side-scroll"},oe={class:"aminui-body el-container"},re={class:"adminui-main",id:"adminui-main"},ue={class:"adminui-header"},de={class:"logo-bar"},ce={class:"version"},me={class:"adminui-header-right"},he={class:"aminui-wrapper"},pe={class:"adminui-side-scroll"},fe={class:"aminui-body el-container"},ge={class:"adminui-main",id:"adminui-main"},ve={class:"adminui-header"},ye={class:"logo-bar"},be={class:"version"},_e={class:"adminui-header-right"},ke={key:0,class:"adminui-header-menu"},$e={class:"aminui-wrapper"},Ce={class:"aminui-body el-container"},we={class:"adminui-main",id:"adminui-main"},Te={key:3,class:"aminui-wrapper"},xe={key:0,class:"aminui-side-split"},Me={class:"aminui-side-split-top"},Ee=["title"],Ie={class:"adminui-side-split-scroll"},Le=["onClick"],Pe={key:0,class:"adminui-side-top"},Oe={class:"adminui-side-scroll"},Ae={class:"aminui-body el-container"},Ve={class:"adminui-main",id:"adminui-main"};const Ne=w({name:"index",components:{SideM:j,Topbar:F,Tags:R,NavMenu:V,userbar:w({components:{search:K,tasks:q,message:J},computed:{avatar:()=>x},async created(){this.user=this.$GLOBAL.user;let e=await this.$API.sys_sitemsg.unreadCount.post();this.unreadCnt=e.data,await this.getFailJobsCnt()},data(){return{config:{dark:this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK},user:{},userName:"",userNameF:"",searchVisible:!1,tasksVisible:!1,msg:!1,unreadCnt:0,failJobCnt:0}},methods:{async getFailJobsCnt(){if(this.$GLOBAL.permissions.some((e=>"*/*/*"===e||"sys/job/userbar"===e))){const e=await this.$API.sys_job.countRecord.post({dynamicFilter:{filters:[{field:"createdTime",operator:"dateRange",value:[this.$TOOL.data.get("APP_SET_FAIL_JOB_VIEW_TIME")??this.$TOOL.dateFormat(new Date,"yyyy-MM-dd"),this.$TOOL.dateFormat(new Date,"yyyy-MM-dd hh:mm:ss")]},{logic:"or",filters:[{field:"httpStatusCode",operator:"range",value:"300,399"},{field:"httpStatusCode",operator:"range",value:"400,499"},{field:"httpStatusCode",operator:"range",value:"500,599"},{field:"httpStatusCode",operator:"range",value:"900,999"}]}]}});this.failJobCnt=e.data}},taskClose(){setTimeout((()=>{this.getFailJobsCnt()}),2e3)},clearData(e){const t=this.$loading();this.$TOOL.cookie.clear(),e?this.$TOOL.data.clear():this.$TOOL.data.clearAppSet(),this.$router.replace({path:"/guest/login"}),setTimeout((()=>{t.close(),location.reload()}),1e3)},configDark(){this.config.dark=!this.config.dark},gotoMsgCenter(){this.$router.push({path:"/profile/message"}),this.msg=!1},async handleUser(e){if("uc"===e&&this.$router.push({path:"/profile/account"}),"cmd"===e&&this.$router.push({path:"/cmd"}),"clearCache"===e)try{await this.$confirm(this.$t("清除缓存会将系统初始化，包括登录状态、主题、语言设置等，是否继续？"),this.$t("提示"),{type:"info"}),this.clearData(!0)}catch{}if("outLogin"===e)try{await this.$confirm(this.$t("确认是否退出当前用户？"),this.$t("提示"),{type:"warning",confirmButtonText:this.$t("退出"),confirmButtonClass:"el-button--danger"}),this.clearData(!1)}catch{}},screen(){this.$TOOL.screen(document.documentElement)},showMsg(){this.msg=!0},search(){this.searchVisible=!0},tasks(){this.tasksVisible=!0}},props:[],watch:{"config.dark"(e){e?(document.documentElement.classList.add("dark"),this.$TOOL.data.set("APP_SET_DARK",e)):(document.documentElement.classList.remove("dark"),this.$TOOL.data.remove("APP_SET_DARK"))}}},[["render",function(s,l,d,f,v,y){const b=m("el-icon"),_=m("el-icon-search"),k=m("el-icon-full-screen"),$=m("sc-icon-ScheduledJob"),C=m("el-badge"),w=m("el-icon-chat-dot-round"),T=m("message"),x=m("el-main"),M=m("el-button"),E=m("el-footer"),I=m("el-container"),L=m("el-drawer"),P=m("el-avatar"),O=m("el-icon-arrow-down"),A=m("el-dropdown-item"),V=m("el-dropdown-menu"),N=m("el-dropdown"),j=m("search"),S=m("el-dialog"),D=m("tasks"),U=p("auth");return e(),t(a,null,[r("div",W,[r("div",{onClick:l[0]||(l[0]=(...e)=>y.configDark&&y.configDark(...e)),class:"tasks panel-item"},[i(b,null,{default:o((()=>[(e(),n(c(v.config.dark?"el-icon-sunny":"el-icon-moon")))])),_:1})]),r("div",{onClick:l[1]||(l[1]=(...e)=>y.search&&y.search(...e)),class:"panel-item hidden-sm-and-down userbar-btn-search"},[i(b,null,{default:o((()=>[i(_)])),_:1})]),r("div",{onClick:l[2]||(l[2]=(...e)=>y.screen&&y.screen(...e)),class:"screen panel-item hidden-sm-and-down"},[i(b,null,{default:o((()=>[i(k)])),_:1})]),h((e(),t("div",{onClick:l[3]||(l[3]=(...e)=>y.tasks&&y.tasks(...e)),class:"tasks panel-item"},[i(C,{hidden:0===v.failJobCnt,value:v.failJobCnt},{default:o((()=>[i(b,null,{default:o((()=>[i($)])),_:1})])),_:1},8,["hidden","value"])])),[[U,"sys/job/userbar"]]),r("div",{onClick:l[5]||(l[5]=(...e)=>y.showMsg&&y.showMsg(...e)),class:"msg panel-item"},[i(C,{hidden:0===v.unreadCnt,value:v.unreadCnt,class:"badge",type:"danger"},{default:o((()=>[i(b,null,{default:o((()=>[i(w)])),_:1})])),_:1},8,["hidden","value"]),i(L,{modelValue:v.msg,"onUpdate:modelValue":l[4]||(l[4]=e=>v.msg=e),title:s.$t("新消息"),"append-to-body":"","destroy-on-close":""},{default:o((()=>[i(I,null,{default:o((()=>[i(x,{style:{padding:"0 1rem"}},{default:o((()=>[i(T)])),_:1}),i(E,{style:{height:"unset"}},{default:o((()=>[i(M,{onClick:y.gotoMsgCenter},{default:o((()=>[g(u(s.$t("消息中心")),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue","title"])]),i(N,{onCommand:y.handleUser,class:"user panel-item",trigger:"hover"},{dropdown:o((()=>[i(V,null,{default:o((()=>[i(A,{command:"uc"},{default:o((()=>[g(u(s.$t("个人中心")),1)])),_:1}),i(A,{command:"clearCache"},{default:o((()=>[g(u(s.$t("清除缓存")),1)])),_:1}),i(A,{command:"outLogin",divided:""},{default:o((()=>[g(u(s.$t("退出登录")),1)])),_:1})])),_:1})])),default:o((()=>[r("div",H,[i(P,{size:30,src:v.user.avatar?v.user.avatar:"data:image/svg+xml,"+encodeURIComponent(y.avatar.createSVG(`#${Math.abs(this.$TOOL.crypto.hashCode(v.user.userName)).toString(16).substring(0,6)}`,v.user.userName.slice(0,1).toUpperCase()).outerHTML)},null,8,["src"]),r("label",null,u(v.user.userName),1),i(b,{class:"el-icon--right"},{default:o((()=>[i(O)])),_:1})])])),_:1},8,["onCommand"])]),i(S,{modelValue:v.searchVisible,"onUpdate:modelValue":l[7]||(l[7]=e=>v.searchVisible=e),title:s.$t("搜索"),width:700,center:"","destroy-on-close":""},{default:o((()=>[i(j,{onSuccess:l[6]||(l[6]=e=>v.searchVisible=!1)})])),_:1},8,["modelValue","title"]),i(L,{modelValue:v.tasksVisible,"onUpdate:modelValue":l[9]||(l[9]=e=>v.tasksVisible=e),size:800,title:s.$t("作业中心"),onClose:y.taskClose,"destroy-on-close":""},{default:o((()=>[i(D,{fail:v.failJobCnt,onClosed:l[8]||(l[8]=e=>v.tasksVisible=!1)},null,8,["fail"])])),_:1},8,["modelValue","title","onClose"])],64)}],["__scopeId","data-v-13bdeb7d"]]),iframeView:w({data:()=>({}),watch:{$route(e){this.push(e)}},created(){this.push(this.$route)},computed:{iframeList(){return this.$store.state.iframe.iframeList},ismobile(){return this.$store.state.global.ismobile},layoutTags(){return this.$store.state.global.layoutTags}},mounted(){},methods:{push(e){"iframe"===e.meta.type?this.ismobile||!this.layoutTags?this.$store.commit("setIframeList",e):this.$store.commit("pushIframeList",e):!this.ismobile&&this.layoutTags||this.$store.commit("clearIframeList")}}},[["render",function(i,s,n,o,r,u){return h((e(),t("div",X,[(e(!0),t(a,null,l(u.iframeList,(s=>h((e(),t("iframe",{key:s.meta.url,src:s.meta.url,frameborder:"0"},null,8,Q)),[[$,i.$route.meta.url===s.meta.url]]))),128))],512)),[[$,"iframe"===i.$route.meta.type]])}],["__scopeId","data-v-75231f99"]]),autoExit:{render(){},data(){return{logoutCount:this.$TOOL.data.get("APP_SET_AUTO_EXIT")||this.$CONFIG.APP_SET_AUTO_EXIT}},mounted(){this.logoutCount&&(this.setNewAutoExitTime(),document.onclick=()=>{this.setNewAutoExitTime()},document.onmousemove=()=>{this.setNewAutoExitTime()},document.onkeydown=()=>{this.setNewAutoExitTime()},document.onscroll=()=>{this.setNewAutoExitTime()},window.autoExitTimer=window.setInterval(this.autoExitFun,1e3))},unmounted(){this.logoutCount&&(clearInterval(window.autoExitTimer),window.autoExitTimer=null)},methods:{setNewAutoExitTime(){window.autoExitTime=(new Date).getTime()},autoExitFun(){(new Date).getTime()-window.autoExitTime>60*this.logoutCount*1e3&&(clearInterval(window.autoExitTimer),window.autoExitTimer=null,this.$router.replace({path:"/guest/login"}),this.$alert("用户长时间无操作，为保证账户安全，系统已自动登出。","提示",{type:"warning",center:!0,roundButton:!0}))}}}},data:()=>({routerViewKey:0,menu:[],nextMenu:[],pmenu:{},active:"",version:""}),computed:{ismobile(){return this.$store.state.global.ismobile},layout(){return this.$store.state.global.layout},layoutTags(){return this.$store.state.global.layoutTags},menuIsCollapse(){return this.$store.state.global.menuIsCollapse}},async created(){this.onLayoutResize(),window.addEventListener("resize",this.onLayoutResize);const e=this.$router.sc_getMenu();this.menu=this.filterUrl(e),this.showThis();const t=await this.$API.sys_tools.getVersion.post();this.version=t.data.slice(0,t.data.indexOf("+"))},watch:{$route(){this.showThis()},layout:{handler(e){document.body.setAttribute("data-layout",e)},immediate:!0}},methods:{logoClick(){this.$router.push({path:"/"})},onLayoutResize(){this.$store.commit("SET_ismobile",document.body.clientWidth<992)},showThis(){this.pmenu=this.$route.meta.breadcrumb?this.$route.meta.breadcrumb[0]:{},this.nextMenu=this.filterUrl(this.pmenu.children),this.$nextTick((()=>{this.active=this.$route.meta.active||this.$route.fullPath}))},showMenu(e){this.pmenu=e,this.nextMenu=this.filterUrl(e.children),e.children&&0!==e.children.length||!e.component||this.$router.push({path:e.path})},filterUrl(e){const t=[];return e&&e.forEach((e=>{if(e.meta=e.meta?e.meta:{},e.meta.hidden||"button"===e.meta.type)return!1;"iframe"===e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&(e.children=this.filterUrl(e.children)),t.push(e)})),t},exitMaximize(){document.getElementById("app").classList.remove("main-maximize")}}},[["render",function(d,h,p,f,g,v){const b=m("el-icon"),_=m("userbar"),k=m("NavMenu"),$=m("el-menu"),w=m("el-scrollbar"),T=m("el-icon-expand"),x=m("el-icon-fold"),M=m("Side-m"),I=m("Tags"),L=m("router-view"),P=m("iframe-view"),O=m("router-link"),A=m("Topbar"),V=m("el-icon-close"),N=m("auto-exit");return e(),t(a,null,["header"===v.layout?(e(),t(a,{key:0},[r("header",Y,[r("div",{onClick:h[0]||(h[0]=(...e)=>v.logoClick&&v.logoClick(...e)),class:"adminui-header-left"},[r("div",Z,[h[7]||(h[7]=r("img",{class:"logo logo-fill-color",src:E},null,-1)),r("div",null,[r("p",null,u(d.$CONFIG.APP_NAME),1),r("p",ee,u(g.version),1)])]),v.ismobile?s("",!0):(e(),t("ul",te,[(e(!0),t(a,null,l(g.menu,(s=>(e(),t("li",{class:y(g.pmenu.path===s.path?"active":""),key:s,onClick:e=>v.showMenu(s)},[i(b,null,{default:o((()=>[(e(),n(c(s.meta.icon||"el-icon-menu")))])),_:2},1024),r("span",null,u(s.meta.title),1)],10,ie)))),128))]))]),r("div",se,[i(_)])]),r("section",ae,[!v.ismobile&&g.nextMenu.length>0||!g.pmenu.component&&g.pmenu.meta?(e(),t("div",{key:0,class:y(v.menuIsCollapse?"aminui-side isCollapse":"aminui-side")},[v.menuIsCollapse?s("",!0):(e(),t("div",le,[r("h2",null,u(g.pmenu.meta.title),1)])),r("div",ne,[i(w,null,{default:o((()=>[i($,{collapse:v.menuIsCollapse,"default-active":g.active,"unique-opened":d.$CONFIG.APP_SET_MENU_UNIQUE_OPENED,router:""},{default:o((()=>[i(k,{navMenus:g.nextMenu},null,8,["navMenus"])])),_:1},8,["collapse","default-active","unique-opened"])])),_:1})]),r("div",{onClick:h[1]||(h[1]=e=>d.$store.commit("TOGGLE_menuIsCollapse")),class:"adminui-side-bottom"},[i(b,null,{default:o((()=>[v.menuIsCollapse?(e(),n(T,{key:0})):(e(),n(x,{key:1}))])),_:1})])],2)):s("",!0),v.ismobile?(e(),n(M,{key:1})):s("",!0),r("div",oe,[!v.ismobile&&v.layoutTags?(e(),n(I,{key:0,vue:this})):s("",!0),r("div",re,[(e(),n(L,{key:g.routerViewKey},{default:o((({Component:t})=>[(e(),n(C,{max:5},[d.$store.state.keepAlive.routeShow?(e(),n(c(t),{key:d.$route.fullPath})):s("",!0)],1024))])),_:1})),i(P)])])])],64)):"menu"===v.layout?(e(),t(a,{key:1},[r("header",ue,[r("div",{onClick:h[2]||(h[2]=(...e)=>v.logoClick&&v.logoClick(...e)),class:"adminui-header-left"},[r("div",de,[h[8]||(h[8]=r("img",{class:"logo logo-fill-color",src:E},null,-1)),r("div",null,[r("p",null,u(d.$CONFIG.APP_NAME),1),r("p",ce,u(g.version),1)])])]),r("div",me,[i(_)])]),r("section",he,[v.ismobile?s("",!0):(e(),t("div",{key:0,class:y(v.menuIsCollapse?"aminui-side isCollapse":"aminui-side")},[r("div",pe,[i(w,null,{default:o((()=>[i($,{collapse:v.menuIsCollapse,"default-active":g.active,"unique-opened":d.$CONFIG.APP_SET_MENU_UNIQUE_OPENED,router:""},{default:o((()=>[i(k,{navMenus:g.menu},null,8,["navMenus"])])),_:1},8,["collapse","default-active","unique-opened"])])),_:1})]),r("div",{onClick:h[3]||(h[3]=e=>d.$store.commit("TOGGLE_menuIsCollapse")),class:"adminui-side-bottom"},[i(b,null,{default:o((()=>[v.menuIsCollapse?(e(),n(T,{key:0})):(e(),n(x,{key:1}))])),_:1})])],2)),v.ismobile?(e(),n(M,{key:1})):s("",!0),r("div",fe,[!v.ismobile&&v.layoutTags?(e(),n(I,{key:0,vue:this})):s("",!0),r("div",ge,[(e(),n(L,{key:g.routerViewKey},{default:o((({Component:t})=>[(e(),n(C,{max:5},[d.$store.state.keepAlive.routeShow?(e(),n(c(t),{key:d.$route.fullPath})):s("",!0)],1024))])),_:1})),i(P)])])])],64)):"dock"===v.layout?(e(),t(a,{key:2},[r("header",ve,[r("div",{onClick:h[4]||(h[4]=(...e)=>v.logoClick&&v.logoClick(...e)),class:"adminui-header-left"},[r("div",ye,[h[9]||(h[9]=r("img",{class:"logo logo-fill-color",src:E},null,-1)),r("div",null,[r("p",null,u(d.$CONFIG.APP_NAME),1),r("p",be,u(g.version),1)])])]),r("div",_e,[v.ismobile?s("",!0):(e(),t("div",ke,[i($,{"default-active":g.active,"active-text-color":"var(--el-color-primary)",mode:"horizontal",router:"","text-color":"var(--el-text-color-primary)"},{default:o((()=>[i(k,{navMenus:g.menu},null,8,["navMenus"])])),_:1},8,["default-active"])])),v.ismobile?(e(),n(M,{key:1})):s("",!0),i(_)])]),r("section",$e,[r("div",Ce,[!v.ismobile&&v.layoutTags?(e(),n(I,{key:0,vue:this})):s("",!0),r("div",we,[(e(),n(L,{key:g.routerViewKey},{default:o((({Component:t})=>[(e(),n(C,{max:5},[d.$store.state.keepAlive.routeShow?(e(),n(c(t),{key:d.$route.fullPath})):s("",!0)],1024))])),_:1})),i(P)])])])],64)):(e(),t("section",Te,[v.ismobile?s("",!0):(e(),t("div",xe,[r("div",Me,[i(O,{to:d.$CONFIG.DASHBOARD_URL},{default:o((()=>[r("img",{title:d.$CONFIG.APP_NAME,class:"logo logo-fill-color",src:E},null,8,Ee)])),_:1},8,["to"])]),r("div",Ie,[i(w,null,{default:o((()=>[r("ul",null,[(e(!0),t(a,null,l(g.menu,(s=>(e(),t("li",{class:y(g.pmenu.path===s.path?"active":""),key:s,onClick:e=>v.showMenu(s)},[i(b,null,{default:o((()=>[(e(),n(c(s.meta.icon||"el-icon-menu")))])),_:2},1024),r("p",null,u(s.meta.title),1)],10,Le)))),128))])])),_:1})])])),!v.ismobile&&g.nextMenu.length>0||!g.pmenu.component&&g.pmenu.meta?(e(),t("div",{key:1,class:y(v.menuIsCollapse?"aminui-side isCollapse":"aminui-side")},[v.menuIsCollapse?s("",!0):(e(),t("div",Pe,[r("h2",null,u(g.pmenu.meta.title),1)])),r("div",Oe,[i(w,null,{default:o((()=>[i($,{collapse:v.menuIsCollapse,"default-active":g.active,"unique-opened":d.$CONFIG.APP_SET_MENU_UNIQUE_OPENED,router:""},{default:o((()=>[i(k,{navMenus:g.nextMenu},null,8,["navMenus"])])),_:1},8,["collapse","default-active","unique-opened"])])),_:1})]),r("div",{onClick:h[5]||(h[5]=e=>d.$store.commit("TOGGLE_menuIsCollapse")),class:"adminui-side-bottom"},[i(b,null,{default:o((()=>[v.menuIsCollapse?(e(),n(T,{key:0})):(e(),n(x,{key:1}))])),_:1})])],2)):s("",!0),v.ismobile?(e(),n(M,{key:2})):s("",!0),r("div",Ae,[i(A,null,{default:o((()=>[i(_)])),_:1}),!v.ismobile&&v.layoutTags?(e(),n(I,{key:0,vue:this})):s("",!0),r("div",Ve,[(e(),n(L,{key:g.routerViewKey},{default:o((({Component:t})=>[(e(),n(C,{max:5},[d.$store.state.keepAlive.routeShow?(e(),n(c(t),{key:d.$route.fullPath})):s("",!0)],1024))])),_:1})),i(P)])])])),r("div",{onClick:h[6]||(h[6]=(...e)=>v.exitMaximize&&v.exitMaximize(...e)),class:"main-maximize-exit"},[i(b,null,{default:o((()=>[i(V)])),_:1})]),i(N)],64)}],["__scopeId","data-v-f88cb11b"]]);export{Ne as default};
