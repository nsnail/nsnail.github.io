const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-DYX4ZhKV.js","./index-Bx7rElEd.js","./@vue-_BCsYqm-.js","./element-plus-CoQd9HEf.js","./lodash-es-DCh--ulG.js","./@vueuse-DKZ1O7gq.js","./@element-plus-DpD46RjY.js","./@sxzz-CpAfbxx4.js","./@ctrl-D2oWfImC.js","./dayjs-Cud5yAXI.js","./async-validator-BTKOuuO-.js","./memoize-one-Ds0C_khL.js","./normalize-wheel-es-Vn5vHDCm.js","./@floating-ui-DT7V1Oc1.js","../css/element-plus-B3lJtvYm.css","./crypto-js-BfYQ37JU.js","./axios-DMXdiZgf.js","./vue-router-DP39kmEB.js","./nprogress-BX4rmQ7W.js","../css/nprogress-BgDCIyLK.css","./vuex-CNGLPxA3.js","./json-bigint-D0bu8vFr.js","./bignumber.js-iDjSUVmj.js","./vue-i18n-DbMEmpqT.js","./@intlify-CZIS8eQd.js","./vue3-json-viewer-B-aZDOpp.js","../css/vue3-json-viewer-ByH33Jf7.css","./ace-builds-D9YH2WY7.js","./vue3-ace-editor-ubj-WOyx.js","./resize-observer-polyfill-CzGuHLZU.js","./sortablejs-BALiOaUQ.js","./vkbeautify-DEVEMlla.js","../css/index-CllpfDYF.css","./index-C_cDTNW2.js","./index-DyNUhUhu.js","../css/index-DLmHlZ99.css"])))=>i.map(i=>d[i]);
import{_ as e,a as l}from"./index-Bx7rElEd.js";import{v as a}from"./vkbeautify-DEVEMlla.js";import{aj as o,at as t,o as r,J as d,K as m,S as s,P as i,Q as u,O as n,L as p,c as f,R as b,a7 as c,a as h,aE as V}from"./@vue-_BCsYqm-.js";import"./element-plus-CoQd9HEf.js";import"./lodash-es-DCh--ulG.js";import"./@vueuse-DKZ1O7gq.js";import"./@element-plus-DpD46RjY.js";import"./@sxzz-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Cud5yAXI.js";import"./async-validator-BTKOuuO-.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./crypto-js-BfYQ37JU.js";import"./axios-DMXdiZgf.js";import"./vue-router-DP39kmEB.js";import"./nprogress-BX4rmQ7W.js";import"./vuex-CNGLPxA3.js";import"./json-bigint-D0bu8vFr.js";import"./bignumber.js-iDjSUVmj.js";import"./vue-i18n-DbMEmpqT.js";import"./@intlify-CZIS8eQd.js";import"./vue3-json-viewer-B-aZDOpp.js";import"./ace-builds-D9YH2WY7.js";import"./vue3-ace-editor-ubj-WOyx.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./sortablejs-BALiOaUQ.js";const _=V((()=>l((()=>import("./index-DYX4ZhKV.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url))),$=V((()=>l((()=>import("./index-C_cDTNW2.js")),__vite__mapDeps([33,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url))),v=V((()=>l((()=>import("./index-DyNUhUhu.js")),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,35]),import.meta.url))),y={class:"flex gap05"};const j=e({components:{Record:_,naUserSelect:$,scCron:v},data(){return{form:{executionCron:"0 * * * * ?",httpMethod:"Post",requestHeader:'{ "Content-Type": "application/json" }',requestBody:"{}"},loading:!0,mode:"add",rules:{executionCron:[{required:!0,pattern:this.$GLOBAL.chars.RGXL_CRON,message:this.$t("执行计划不正确")}],httpMethod:[{required:!0,message:this.$t("请求方不能为空")}],jobName:[{required:!0,message:this.$t("作业名称不能为空")}],requestHeader:[{validator:(e,l,a)=>{if(!l)return a();try{JSON.parse(l)}catch{return a(this.$t("请求头不正确"))}return a()}}],requestUrl:[{required:!0,pattern:this.$GLOBAL.chars.RGX_URL,message:this.$t("请求的网络地址不正确")}],user:[{required:!0,trigger:"blur",message:this.$t("执行用户不能为空"),validator:(e,l,a)=>{l.id?a():a(new Error)}}]},tabId:"0",titleMap:{add:this.$t("新增作业"),edit:this.$t("编辑作业"),view:this.$t("查看作业")},visible:!1}},emits:["success","closed","mounted"],methods:{jsonFormat(e){try{e=this.vkbeautify().json(e,2)}catch{this.$message.error(this.$t("非JSON格式"))}return e},vkbeautify:()=>a,async open(e){var l;if(this.visible=!0,this.loading=!0,this.mode=e.mode,null==(l=e.row)?void 0:l.id){const l=await this.$API.sys_job.get.post({id:e.row.id});Object.assign(this.form,l.data)}return this.loading=!1,this.tabId=e.tabId??"0",this},async submit(){if(!(await this.$refs.dialogForm.validate().catch((()=>{}))))return!1;this.loading=!0;const e="add"===this.mode?this.$API.sys_job.create:this.$API.sys_job.edit;try{const l=await e.post(Object.assign({},this.form,{userId:this.form.user.id,requestHeaders:JSON.parse(this.form.requestHeader)}));l.data?(this.$emit("success",l.data,this.mode),this.$message.success(this.$t("操作成功"))):this.$message.error(this.$t("操作失败")),this.visible=!1}catch{}this.loading=!1}},mounted(){this.$emit("mounted")}},[["render",function(e,l,a,V,_,$){var v;const j=o("el-input"),g=o("el-form-item"),U=o("scCron"),k=o("el-option"),w=o("el-select"),x=o("VAceEditor"),T=o("el-button"),I=o("naUserSelect"),E=o("el-form"),q=o("el-tab-pane"),O=o("record"),A=o("JsonViewer"),P=o("el-tabs"),C=o("scDialog"),N=t("loading");return r(),d(C,{modelValue:_.visible,"onUpdate:modelValue":l[28]||(l[28]=e=>_.visible=e),title:`${_.titleMap[_.mode]}：${(null==(v=_.form)?void 0:v.id)??"..."}`,onClosed:l[29]||(l[29]=l=>e.$emit("closed")),"destroy-on-close":"","full-screen":""},{footer:m((()=>[s(T,{onClick:l[27]||(l[27]=e=>_.visible=!1)},{default:m((()=>[i(u(e.$t("取消")),1)])),_:1}),"view"!==_.mode?(r(),d(T,{key:0,disabled:_.loading,loading:_.loading,onClick:$.submit,type:"primary"},{default:m((()=>[i(u(e.$t("保存")),1)])),_:1},8,["disabled","loading","onClick"])):n("",!0)])),default:m((()=>[s(P,{modelValue:_.tabId,"onUpdate:modelValue":l[26]||(l[26]=e=>_.tabId=e),"tab-position":"top"},{default:m((()=>[s(q,{label:e.$t("基本信息")},{default:m((()=>[p((r(),d(E,{disabled:"view"===_.mode,model:_.form,rules:_.rules,"label-position":"right","label-width":"20rem",ref:"dialogForm"},{default:m((()=>["view"===_.mode?(r(),d(g,{key:0,label:e.$t("作业编号"),prop:"id"},{default:m((()=>[s(j,{modelValue:_.form.id,"onUpdate:modelValue":l[0]||(l[0]=e=>_.form.id=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),s(g,{label:e.$t("执行计划"),prop:"executionCron"},{default:m((()=>[s(U,{modelValue:_.form.executionCron,"onUpdate:modelValue":l[1]||(l[1]=e=>_.form.executionCron=e),class:"font-monospace",clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),s(g,{label:e.$t("请求方法"),prop:"httpMethod"},{default:m((()=>[s(w,{modelValue:_.form.httpMethod,"onUpdate:modelValue":l[2]||(l[2]=e=>_.form.httpMethod=e),clearable:"",filterable:""},{default:m((()=>[(r(!0),f(b,null,c(e.$GLOBAL.enums.httpMethods,((e,l)=>(r(),d(k,{key:l,label:e[1],value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"]),s(g,{label:e.$t("作业名称"),prop:"jobName"},{default:m((()=>[s(j,{modelValue:_.form.jobName,"onUpdate:modelValue":l[3]||(l[3]=e=>_.form.jobName=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),s(g,{label:e.$t("备注"),prop:"summary"},{default:m((()=>[s(j,{modelValue:_.form.summary,"onUpdate:modelValue":l[4]||(l[4]=e=>_.form.summary=e),clearable:"",type:"textarea"},null,8,["modelValue"])])),_:1},8,["label"]),"view"===_.mode?(r(),d(g,{key:1,label:e.$t("上次执行时间"),prop:"lastExecTime"},{default:m((()=>[s(j,{modelValue:_.form.lastExecTime,"onUpdate:modelValue":l[5]||(l[5]=e=>_.form.lastExecTime=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:2,label:e.$t("上次执行耗时（毫秒）"),prop:"lastExecTime"},{default:m((()=>[s(j,{modelValue:_.form.lastDuration,"onUpdate:modelValue":l[6]||(l[6]=e=>_.form.lastDuration=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:3,label:e.$t("下次执行时间"),prop:"nextExecTime"},{default:m((()=>[s(j,{modelValue:_.form.nextExecTime,"onUpdate:modelValue":l[7]||(l[7]=e=>_.form.nextExecTime=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:4,label:e.$t("下次执行时间编号"),prop:"nextTimeId"},{default:m((()=>[s(j,{modelValue:_.form.nextTimeId,"onUpdate:modelValue":l[8]||(l[8]=e=>_.form.nextTimeId=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),s(g,{label:e.$t("请求头"),prop:"requestHeader"},{default:m((()=>[s(x,{value:_.form.requestHeader,"onUpdate:value":l[9]||(l[9]=e=>_.form.requestHeader=e),theme:this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"github_dark":"github",lang:"json",style:{height:"10rem",width:"100%"}},null,8,["value","theme"]),s(T,{onClick:l[10]||(l[10]=e=>_.form.requestHeader=$.jsonFormat(_.form.requestHeader)),link:"",type:"primary"},{default:m((()=>[i(u(e.$t("JSON 格式化")),1)])),_:1})])),_:1},8,["label"]),s(g,{label:e.$t("请求体"),prop:"requestBody"},{default:m((()=>[s(x,{value:_.form.requestBody,"onUpdate:value":l[11]||(l[11]=e=>_.form.requestBody=e),theme:this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"github_dark":"github",lang:"json",style:{height:"15rem",width:"100%"}},null,8,["value","theme"]),s(T,{onClick:l[12]||(l[12]=e=>_.form.requestBody=$.jsonFormat(_.form.requestBody)),link:"",type:"primary"},{default:m((()=>[i(u(e.$t("JSON 格式化")),1)])),_:1})])),_:1},8,["label"]),s(g,{label:e.$t("请求的网络地址"),prop:"requestUrl"},{default:m((()=>[s(j,{modelValue:_.form.requestUrl,"onUpdate:modelValue":l[13]||(l[13]=e=>_.form.requestUrl=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),s(g,{label:e.$t("随机延时")},{default:m((()=>[h("div",y,[s(j,{modelValue:_.form.randomDelayBegin,"onUpdate:modelValue":l[14]||(l[14]=e=>_.form.randomDelayBegin=e),placeholder:e.$t("起始值（毫秒）"),class:"w15",clearable:"",oninput:"value=value.replace(/[^0-9]/g,'')"},null,8,["modelValue","placeholder"]),s(j,{modelValue:_.form.randomDelayEnd,"onUpdate:modelValue":l[15]||(l[15]=e=>_.form.randomDelayEnd=e),placeholder:e.$t("结束值（毫秒）"),class:"w15",clearable:"",oninput:"value=value.replace(/[^0-9]/g,'')"},null,8,["modelValue","placeholder"])])])),_:1},8,["label"]),"view"===_.mode?(r(),d(g,{key:5,label:e.$t("作业状态"),prop:"status"},{default:m((()=>[s(j,{modelValue:_.form.status,"onUpdate:modelValue":l[16]||(l[16]=e=>_.form.status=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:6,label:e.$t("执行用户编号"),prop:"userId"},{default:m((()=>[s(j,{modelValue:_.form.userId,"onUpdate:modelValue":l[17]||(l[17]=e=>_.form.userId=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):(r(),d(g,{key:7,label:e.$t("执行用户"),prop:"user"},{default:m((()=>[s(I,{modelValue:_.form.user,"onUpdate:modelValue":l[18]||(l[18]=e=>_.form.user=e)},null,8,["modelValue"])])),_:1},8,["label"])),"view"===_.mode?(r(),d(g,{key:8,label:e.$t("创建时间"),prop:"createdTime"},{default:m((()=>[s(j,{modelValue:_.form.createdTime,"onUpdate:modelValue":l[19]||(l[19]=e=>_.form.createdTime=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:9,label:e.$t("修改时间"),prop:"modifiedTime"},{default:m((()=>[s(j,{modelValue:_.form.modifiedTime,"onUpdate:modelValue":l[20]||(l[20]=e=>_.form.modifiedTime=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:10,label:e.$t("数据版本"),prop:"version"},{default:m((()=>[s(j,{modelValue:_.form.version,"onUpdate:modelValue":l[21]||(l[21]=e=>_.form.version=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:11,label:e.$t("创建者编号"),prop:"createdUserId"},{default:m((()=>[s(j,{modelValue:_.form.createdUserId,"onUpdate:modelValue":l[22]||(l[22]=e=>_.form.createdUserId=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:12,label:e.$t("创建者用户名"),prop:"createdUserName"},{default:m((()=>[s(j,{modelValue:_.form.createdUserName,"onUpdate:modelValue":l[23]||(l[23]=e=>_.form.createdUserName=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:13,label:e.$t("修改者编号"),prop:"modifiedUserId"},{default:m((()=>[s(j,{modelValue:_.form.modifiedUserId,"onUpdate:modelValue":l[24]||(l[24]=e=>_.form.modifiedUserId=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(g,{key:14,label:e.$t("修改者用户名"),prop:"modifiedUserName"},{default:m((()=>[s(j,{modelValue:_.form.modifiedUserName,"onUpdate:modelValue":l[25]||(l[25]=e=>_.form.modifiedUserName=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):n("",!0)])),_:1},8,["disabled","model","rules"])),[[N,_.loading]])])),_:1},8,["label"]),"view"===_.mode?(r(),d(q,{key:0,label:e.$t("执行记录"),name:"record"},{default:m((()=>["record"===_.tabId?(r(),d(O,{key:0,"job-id":_.form.id},null,8,["job-id"])):n("",!0)])),_:1},8,["label"])):n("",!0),"view"===_.mode?(r(),d(q,{key:1,label:e.$t("原始数据")},{default:m((()=>[s(A,{"expand-depth":5,theme:this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"dark":"light",value:_.form,copyable:"",expanded:"",sort:""},null,8,["theme","value"])])),_:1},8,["label"])):n("",!0)])),_:1},8,["modelValue"])])),_:1},8,["modelValue","title"])}]]);export{j as default};
