const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./catalog-select-FfzObjYz.js","./index-Bx7rElEd.js","./@vue-_BCsYqm-.js","./element-plus-CoQd9HEf.js","./lodash-es-DCh--ulG.js","./@vueuse-DKZ1O7gq.js","./@element-plus-DpD46RjY.js","./@sxzz-CpAfbxx4.js","./@ctrl-D2oWfImC.js","./dayjs-Cud5yAXI.js","./async-validator-BTKOuuO-.js","./memoize-one-Ds0C_khL.js","./normalize-wheel-es-Vn5vHDCm.js","./@floating-ui-DT7V1Oc1.js","../css/element-plus-B3lJtvYm.css","./crypto-js-BfYQ37JU.js","./axios-DMXdiZgf.js","./vue-router-DP39kmEB.js","./nprogress-BX4rmQ7W.js","../css/nprogress-BgDCIyLK.css","./vuex-CNGLPxA3.js","./json-bigint-D0bu8vFr.js","./bignumber.js-iDjSUVmj.js","./vue-i18n-DbMEmpqT.js","./@intlify-CZIS8eQd.js","./vue3-json-viewer-B-aZDOpp.js","../css/vue3-json-viewer-ByH33Jf7.css","./ace-builds-D9YH2WY7.js","./vue3-ace-editor-ubj-WOyx.js","./resize-observer-polyfill-CzGuHLZU.js","./sortablejs-BALiOaUQ.js","./vkbeautify-DEVEMlla.js","../css/index-CllpfDYF.css"])))=>i.map(i=>d[i]);
import{_ as e,D as t,a as i}from"./index-Bx7rElEd.js";import{v as l}from"./aieditor-D176QHWW.js";import{aj as a,at as s,o,J as d,K as r,S as m,P as n,Q as u,O as p,L as c,c as b,R as h,a7 as f,a as g,F as v,aE as j}from"./@vue-_BCsYqm-.js";import"./element-plus-CoQd9HEf.js";import"./lodash-es-DCh--ulG.js";import"./@vueuse-DKZ1O7gq.js";import"./@element-plus-DpD46RjY.js";import"./@sxzz-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Cud5yAXI.js";import"./async-validator-BTKOuuO-.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./crypto-js-BfYQ37JU.js";import"./axios-DMXdiZgf.js";import"./vue-router-DP39kmEB.js";import"./nprogress-BX4rmQ7W.js";import"./vuex-CNGLPxA3.js";import"./json-bigint-D0bu8vFr.js";import"./bignumber.js-iDjSUVmj.js";import"./vue-i18n-DbMEmpqT.js";import"./@intlify-CZIS8eQd.js";import"./vue3-json-viewer-B-aZDOpp.js";import"./ace-builds-D9YH2WY7.js";import"./vue3-ace-editor-ubj-WOyx.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./sortablejs-BALiOaUQ.js";import"./vkbeautify-DEVEMlla.js";const _=e({components:{catalogSelect:j((()=>i((()=>import("./catalog-select-FfzObjYz.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url)))},data(){return{form:{},loading:!0,mode:"add",rules:{catalogId:[{required:!0,message:"请选择所属文档分类"}],title:[{required:!0,message:"请输入文档标题"}],body:[{required:!0,message:"请输入文档内容"}],visibility:[{required:!0,message:"请选择档案可见性"}]},titleMap:{add:this.$t("新增文档"),edit:this.$t("编辑文档"),view:this.$t("查看文档")},visible:!1}},emits:["success","closed","mounted"],methods:{async open(e){var i,a;if(this.visible=!0,this.loading=!0,this.mode=e.mode,this.form.catalogId=null==(i=e.data)?void 0:i.catalogId,null==(a=e.row)?void 0:a.id){const t=await this.$API.sys_doc.getContent.post({id:e.row.id});Object.assign(this.form,t.data)}this.loading=!1,await this.$nextTick();return new l({element:this.$refs.editor,placeholder:this.$t("请输入消息内容..."),content:this.form.body,onChange:e=>{this.form.body=e.getHtml()}}).changeLang(this.$TOOL.data.get("APP_SET_LANG")||t.APP_SET_LANG),this},async submit(){if(!(await this.$refs.dialogForm.validate().catch((()=>{}))))return!1;this.loading=!0;const e="add"===this.mode?this.$API.sys_doc.createContent:this.$API.sys_doc.editContent;try{const t=await e.post(this.form);this.$emit("success",t.data,this.mode),this.visible=!1,this.$message.success(this.$t("操作成功"))}catch{}this.loading=!1}},mounted(){this.$emit("mounted")}},[["render",function(e,t,i,l,j,_){var $;const y=a("catalog-select"),w=a("el-form-item"),A=a("el-input"),P=a("el-option"),V=a("el-select"),I=a("el-form"),O=a("el-tab-pane"),k=a("JsonViewer"),C=a("el-tabs"),T=a("el-button"),E=a("scDialog"),L=s("loading");return o(),d(E,{modelValue:j.visible,"onUpdate:modelValue":t[4]||(t[4]=e=>j.visible=e),title:`${j.titleMap[j.mode]}：${(null==($=j.form)?void 0:$.id)??"..."}`,onClosed:t[5]||(t[5]=t=>e.$emit("closed")),"destroy-on-close":"","full-screen":""},{footer:r((()=>[m(T,{onClick:t[3]||(t[3]=e=>j.visible=!1)},{default:r((()=>[n(u(e.$t("取消")),1)])),_:1}),"view"!==j.mode?(o(),d(T,{key:0,disabled:j.loading,loading:j.loading,onClick:_.submit,type:"primary"},{default:r((()=>[n(u(e.$t("保存")),1)])),_:1},8,["disabled","loading","onClick"])):p("",!0)])),default:r((()=>[c((o(),b("div",null,[m(C,{"tab-position":"top"},{default:r((()=>[m(O,{label:e.$t("基本信息")},{default:r((()=>[m(I,{disabled:"view"===j.mode,model:j.form,rules:j.rules,"label-width":"10rem",ref:"dialogForm"},{default:r((()=>[m(w,{label:e.$t("所属文档分类"),prop:"catalogId"},{default:r((()=>[m(y,{modelValue:j.form.catalogId,"onUpdate:modelValue":t[0]||(t[0]=e=>j.form.catalogId=e),class:"w100p"},null,8,["modelValue"])])),_:1},8,["label"]),m(w,{label:e.$t("文档标题"),prop:"title"},{default:r((()=>[m(A,{modelValue:j.form.title,"onUpdate:modelValue":t[1]||(t[1]=e=>j.form.title=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),m(w,{label:e.$t("档案可见性"),prop:"visibility"},{default:r((()=>[m(V,{modelValue:j.form.visibility,"onUpdate:modelValue":t[2]||(t[2]=e=>j.form.visibility=e),clearable:"",filterable:""},{default:r((()=>[(o(!0),b(h,null,f(e.$GLOBAL.enums.archiveVisibilities,((e,t)=>(o(),d(P,{key:t,label:e[1],value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"]),m(w,{label:e.$t("文档内容"),prop:"body"},{default:r((()=>[g("div",{class:v(this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"aie-theme-dark editor":"aie-theme-light editor"),ref:"editor"},null,2)])),_:1},8,["label"])])),_:1},8,["disabled","model","rules"])])),_:1},8,["label"]),"view"===j.mode?(o(),d(O,{key:0,label:e.$t("原始数据")},{default:r((()=>[m(k,{"expand-depth":5,theme:this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"dark":"light",value:j.form,copyable:"",expanded:"",sort:""},null,8,["theme","value"])])),_:1},8,["label"])):p("",!0)])),_:1})])),[[L,j.loading]])])),_:1},8,["modelValue","title"])}],["__scopeId","data-v-985de230"]]);export{_ as default};
