import{n as t}from"./index-BCMzXIui.js";import{aj as e,at as s,o as a,c as i,S as l,K as o,L as r,a as n,a8 as c,Y as u,P as d,Q as p,J as h,O as m,R as y}from"./@vue-_BCsYqm-.js";import{_ as f}from"./index-Bx7rElEd.js";import"./element-plus-CoQd9HEf.js";import"./lodash-es-DCh--ulG.js";import"./@vueuse-DKZ1O7gq.js";import"./@element-plus-DpD46RjY.js";import"./@sxzz-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Cud5yAXI.js";import"./async-validator-BTKOuuO-.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./crypto-js-BfYQ37JU.js";import"./axios-DMXdiZgf.js";import"./vue-router-DP39kmEB.js";import"./nprogress-BX4rmQ7W.js";import"./vuex-CNGLPxA3.js";import"./json-bigint-D0bu8vFr.js";import"./bignumber.js-iDjSUVmj.js";import"./vue-i18n-DbMEmpqT.js";import"./@intlify-CZIS8eQd.js";import"./vue3-json-viewer-B-aZDOpp.js";import"./ace-builds-D9YH2WY7.js";import"./vue3-ace-editor-ubj-WOyx.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./sortablejs-BALiOaUQ.js";import"./vkbeautify-DEVEMlla.js";const g={class:"w100p"},v={class:"left-panel"},j={class:"right-panel"};const w=f({components:{naInfo:t},data:()=>({selection:[],loading:!0,dialog:{info:!1},query:{keywords:""},tableData:[],statistics:{keyspaceHits:0,keyspaceMisses:0,upTime:0,usedCpu:0,usedMemory:0,version:""}}),methods:{async batchDel(){let t;try{await this.$confirm(`确定删除选中的 ${this.selection.length} 项吗？`,"提示",{type:"warning"}),t=this.$loading();const e=await this.$API.sys_cache.bulkDeleteEntry.post({items:this.selection});this.$message.success(`删除 ${e.data} 项`)}catch{}await this.getData(),null==t||t.close()},reset(){this.query.keywords="",this.search()},search(){this.getData()},async delClick(t){try{const e=await this.$API.sys_cache.deleteEntry.post({key:t.key});this.$message.success(`删除 ${e.data} 项`)}catch{}await this.getData()},async viewClick(t){this.dialog.info=!0,await this.$nextTick(),await this.$refs.info.open((()=>this.$t("缓存详情")),(()=>this.$API.sys_cache.getEntry.post({key:t.key})))},async getData(){this.loading=!0;try{const t=await this.$API.sys_cache.getAllEntries.post(this.query);t.data&&(this.tableData=t.data)}catch{}this.loading=!1},async cacheStatistics(){try{const t=await this.$API.sys_cache.cacheStatistics.post();t.data&&(this.statistics=t.data)}catch{}}},created(){this.cacheStatistics(),this.getData()}},[["render",function(t,f,w,k,b,_){const $=e("scStatistic"),x=e("el-card"),C=e("el-col"),D=e("el-row"),z=e("el-header"),I=e("el-input"),S=e("el-button"),P=e("el-button-group"),T=e("el-table-column"),A=e("naColOperation"),q=e("scTable"),E=e("el-empty"),M=e("el-main"),F=e("el-container"),H=e("na-info"),R=s("loading");return a(),i(y,null,[l(F,null,{default:o((()=>[l(z,{style:{"flex-direction":"column",height:"auto"}},{default:o((()=>[r((a(),i("div",g,[l(D,{gutter:15},{default:o((()=>[l(C,{lg:4},{default:o((()=>[l(x,{shadow:"never"},{default:o((()=>[l($,{title:t.$t("Redis 版本"),value:b.statistics.version,"group-separator":""},null,8,["title","value"])])),_:1})])),_:1}),l(C,{lg:4},{default:o((()=>[l(x,{shadow:"never"},{default:o((()=>[l($,{suffix:t.$t("天"),title:t.$t("Redis 运行时间"),value:parseInt(b.statistics.upTime/86400),"group-separator":""},null,8,["suffix","title","value"])])),_:1})])),_:1}),l(C,{lg:4},{default:o((()=>[l(x,{shadow:"never"},{default:o((()=>[l($,{title:t.$t("CPU 使用率"),value:b.statistics.upTime?(b.statistics.usedCpu/b.statistics.upTime).toFixed(2):0,"group-separator":"",suffix:"%"},null,8,["title","value"])])),_:1})])),_:1}),l(C,{lg:4},{default:o((()=>[l(x,{shadow:"never"},{default:o((()=>[l($,{title:t.$t("内存使用量"),value:(b.statistics.usedMemory/1024/1024).toFixed(2),"group-separator":"",suffix:"MiB"},null,8,["title","value"])])),_:1})])),_:1}),l(C,{lg:4},{default:o((()=>[l(x,{shadow:"never"},{default:o((()=>[l($,{title:t.$t("缓存数量"),value:b.statistics.dbSize,"group-separator":""},null,8,["title","value"])])),_:1})])),_:1}),l(C,{lg:4},{default:o((()=>[l(x,{shadow:"never"},{default:o((()=>[l($,{title:t.$t("缓存命中率"),value:(b.statistics.keyspaceHits/(b.statistics.keyspaceMisses+b.statistics.keyspaceHits)*100).toFixed(2),"group-separator":"",suffix:"%"},null,8,["title","value"])])),_:1})])),_:1})])),_:1})])),[[R,""===b.statistics.version]])])),_:1}),l(z,null,{default:o((()=>[n("div",v,[n("form",{onKeyup:f[1]||(f[1]=c(((...t)=>_.search&&_.search(...t)),["enter"])),onSubmit:f[2]||(f[2]=u(((...t)=>_.search&&_.search(...t)),["prevent"])),class:"right-panel-search"},[l(I,{modelValue:this.query.keywords,"onUpdate:modelValue":f[0]||(f[0]=t=>this.query.keywords=t),placeholder:t.$t("关键词"),clearable:"",style:{width:"25rem"}},null,8,["modelValue","placeholder"]),l(P,null,{default:o((()=>[l(S,{onClick:_.search,icon:"el-icon-search",type:"primary"},{default:o((()=>[d(p(t.$t("查询")),1)])),_:1},8,["onClick"]),l(S,{onClick:_.reset,icon:"el-icon-refresh-left"},{default:o((()=>[d(p(t.$t("重置")),1)])),_:1},8,["onClick"])])),_:1})],32)]),n("div",j,[l(S,{disabled:0===b.selection.length,onClick:_.batchDel,icon:"el-icon-delete",plain:"",type:"danger"},null,8,["disabled","onClick"])])])),_:1}),r((a(),h(M,{class:"nopadding"},{default:o((()=>[b.tableData.length>0?(a(),h(q,{key:0,data:b.tableData,"page-size":100,onSelectionChange:f[3]||(f[3]=t=>{b.selection=t}),"hide-refresh":"","pagination-layout":"total",stripe:""},{default:o((()=>[l(T,{type:"selection",width:"50"}),l(T,{label:t.$t("键名"),"min-width":"400",prop:"key"},null,8,["label"]),l(T,{label:t.$t("数据类型"),align:"center",prop:"type",width:"100"},null,8,["label"]),l(T,{label:t.$t("过期时间"),align:"right",prop:"expireTime",width:"200"},null,8,["label"]),l(A,{buttons:[{icon:"el-icon-view",title:"查看缓存",click:_.viewClick},{icon:"el-icon-delete",type:"danger",confirm:!0,title:"删除缓存",click:_.delClick}],vue:this,width:"100"},null,8,["buttons"])])),_:1},8,["data"])):(a(),h(E,{key:1}))])),_:1})),[[R,b.loading]])])),_:1}),b.dialog.info?(a(),h(H,{key:0,ref:"info"},null,512)):m("",!0)],64)}],["__scopeId","data-v-4e6a5951"]]);export{w as default};
