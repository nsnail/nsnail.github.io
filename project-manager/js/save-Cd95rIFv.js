const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CQSv1pp1.js","./index-C3Re8InM.js","./@vue-_BCsYqm-.js","./element-plus-CoQd9HEf.js","./lodash-es-DCh--ulG.js","./@vueuse-DKZ1O7gq.js","./@element-plus-DpD46RjY.js","./@sxzz-CpAfbxx4.js","./@ctrl-D2oWfImC.js","./dayjs-Cud5yAXI.js","./async-validator-BTKOuuO-.js","./memoize-one-Ds0C_khL.js","./normalize-wheel-es-Vn5vHDCm.js","./@floating-ui-DT7V1Oc1.js","../css/element-plus-B3lJtvYm.css","./crypto-js-BfYQ37JU.js","./axios-DMXdiZgf.js","./vue-router-CJBOlWwF.js","./nprogress-BX4rmQ7W.js","../css/nprogress-BgDCIyLK.css","./vuex-CNGLPxA3.js","./json-bigint-D0bu8vFr.js","./bignumber.js-iDjSUVmj.js","./vue-i18n-DbMEmpqT.js","./@intlify-CZIS8eQd.js","./vue3-json-viewer-B-aZDOpp.js","../css/vue3-json-viewer-ByH33Jf7.css","./ace-builds-D9YH2WY7.js","./vue3-ace-editor-ubj-WOyx.js","./resize-observer-polyfill-CzGuHLZU.js","./sortablejs-BALiOaUQ.js","./vkbeautify-DEVEMlla.js","../css/index-CllpfDYF.css","./index-B4AJDtyE.js","./index-C0S2aaaZ.js","../css/index-dCvdPCc1.css"])))=>i.map(i=>d[i]);
import{_ as e,D as l,a as t}from"./index-C3Re8InM.js";import{v as a}from"./aieditor-D176QHWW.js";import{aj as s,at as o,o as i,J as d,K as r,S as m,P as u,Q as n,O as p,L as f,c,R as b,a7 as h,a as _,F as g,aE as j}from"./@vue-_BCsYqm-.js";import"./element-plus-CoQd9HEf.js";import"./lodash-es-DCh--ulG.js";import"./@vueuse-DKZ1O7gq.js";import"./@element-plus-DpD46RjY.js";import"./@sxzz-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Cud5yAXI.js";import"./async-validator-BTKOuuO-.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./crypto-js-BfYQ37JU.js";import"./axios-DMXdiZgf.js";import"./vue-router-CJBOlWwF.js";import"./nprogress-BX4rmQ7W.js";import"./vuex-CNGLPxA3.js";import"./json-bigint-D0bu8vFr.js";import"./bignumber.js-iDjSUVmj.js";import"./vue-i18n-DbMEmpqT.js";import"./@intlify-CZIS8eQd.js";import"./vue3-json-viewer-B-aZDOpp.js";import"./ace-builds-D9YH2WY7.js";import"./vue3-ace-editor-ubj-WOyx.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./sortablejs-BALiOaUQ.js";import"./vkbeautify-DEVEMlla.js";const v=e({components:{naDept:j((()=>t((()=>import("./index-CQSv1pp1.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url))),naUserSelect:j((()=>t((()=>import("./index-B4AJDtyE.js")),__vite__mapDeps([33,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url))),scSelect:j((()=>t((()=>import("./index-C0S2aaaZ.js")),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,35]),import.meta.url)))},data(){return{form:{userIds:[],roleIds:[],deptIds:[]},loading:!0,mode:"add",rules:{title:[{required:!0,message:"消息主题不能为空"}],msgType:[{required:!0,message:"请选择消息类型"}],content:[{required:!0,message:"消息内容不能为空"}]},titleMap:{add:this.$t("新增消息"),edit:this.$t("编辑消息"),view:this.$t("查看消息")},visible:!1}},emits:["success","closed","mounted"],methods:{async open(e){var t,s,o;if(this.visible=!0,this.loading=!0,this.mode=e.mode,null==(t=e.row)?void 0:t.id){const l=await this.$API.sys_sitemsg.get.post({id:e.row.id});Object.assign(this.form,l.data,{roleIds:(null==(s=l.data.roles)?void 0:s.map((e=>e.id)))??[],deptIds:(null==(o=l.data.depts)?void 0:o.map((e=>e.id)))??[],userIds:l.data.users??[]})}this.loading=!1,await this.$nextTick();return new a({element:this.$refs.editor,placeholder:this.$t("请输入消息内容..."),content:this.form.content,onChange:e=>{this.form.content=e.getHtml()}}).changeLang(this.$TOOL.data.get("APP_SET_LANG")||l.APP_SET_LANG),this},async submit(){if(!(await this.$refs.dialogForm.validate().catch((()=>{}))))return!1;this.loading=!0;const e="add"===this.mode?this.$API.sys_sitemsg.create:this.$API.sys_sitemsg.edit;try{const l=await e.post(Object.assign({},this.form,{userIds:this.form.userIds.map((e=>e.id))}));this.$emit("success",l.data,this.mode),this.visible=!1,this.$message.success(this.$t("操作成功"))}catch{}this.loading=!1}},mounted(){this.$emit("mounted")}},[["render",function(e,l,t,a,j,v){var $;const y=s("el-input"),V=s("el-form-item"),I=s("el-option"),T=s("el-select"),w=s("scSelect"),P=s("naDept"),A=s("naUserSelect"),O=s("el-tab-pane"),k=s("JsonViewer"),E=s("el-tabs"),x=s("el-form"),D=s("el-button"),L=s("scDialog"),S=o("loading");return i(),d(L,{modelValue:j.visible,"onUpdate:modelValue":l[9]||(l[9]=e=>j.visible=e),title:`${j.titleMap[j.mode]}：${(null==($=j.form)?void 0:$.id)??"..."}`,onClosed:l[10]||(l[10]=l=>e.$emit("closed")),"destroy-on-close":"","full-screen":""},{footer:r((()=>[m(D,{onClick:l[8]||(l[8]=e=>j.visible=!1)},{default:r((()=>[u(n(e.$t("取消")),1)])),_:1}),"view"!==j.mode?(i(),d(D,{key:0,disabled:j.loading,loading:j.loading,onClick:v.submit,type:"primary"},{default:r((()=>[u(n(e.$t("保存")),1)])),_:1},8,["disabled","loading","onClick"])):p("",!0)])),default:r((()=>[f((i(),d(x,{disabled:"view"===j.mode,model:j.form,rules:j.rules,"label-position":"right","label-width":"10rem",ref:"dialogForm"},{default:r((()=>[m(E,{"tab-position":"top"},{default:r((()=>[m(O,{label:e.$t("基本信息")},{default:r((()=>["view"===j.mode?(i(),d(V,{key:0,label:e.$t("消息编号"),prop:"id"},{default:r((()=>[m(y,{modelValue:j.form.id,"onUpdate:modelValue":l[0]||(l[0]=e=>j.form.id=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):p("",!0),m(V,{label:e.$t("消息类型"),prop:"msgType"},{default:r((()=>[m(T,{modelValue:j.form.msgType,"onUpdate:modelValue":l[1]||(l[1]=e=>j.form.msgType=e),clearable:"",filterable:""},{default:r((()=>[(i(!0),c(b,null,h(e.$GLOBAL.enums.siteMsgTypes,((e,l)=>(i(),d(I,{key:l,label:e[1],value:l},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["label"]),m(V,{label:e.$t("消息主题"),prop:"title"},{default:r((()=>[m(y,{modelValue:j.form.title,"onUpdate:modelValue":l[2]||(l[2]=e=>j.form.title=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"]),m(V,{label:e.$t("消息内容"),prop:"content"},{default:r((()=>[_("div",{class:g(this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"aie-theme-dark":"aie-theme-light"),ref:"editor",style:{width:"100%",height:"30rem"}},null,2)])),_:1},8,["label"]),m(V,{label:e.$t("送至角色"),prop:"roleIds"},{default:r((()=>[this.loading?p("",!0):(i(),d(w,{key:0,modelValue:j.form.roleIds,"onUpdate:modelValue":l[3]||(l[3]=e=>j.form.roleIds=e),config:{props:{label:"name",value:"id"}},"query-api":e.$API.sys_role.query,class:"w100p",clearable:"",filterable:"",multiple:""},null,8,["modelValue","query-api"]))])),_:1},8,["label"]),m(V,{label:e.$t("送至部门"),prop:"deptIds"},{default:r((()=>[m(P,{modelValue:j.form.deptIds,"onUpdate:modelValue":l[4]||(l[4]=e=>j.form.deptIds=e),multiple:!0,class:"w100p"},null,8,["modelValue"])])),_:1},8,["label"]),m(V,{label:e.$t("送至用户"),prop:"userIds"},{default:r((()=>[m(A,{modelValue:j.form.userIds,"onUpdate:modelValue":l[5]||(l[5]=e=>j.form.userIds=e),multiple:!0,class:"w100p"},null,8,["modelValue"])])),_:1},8,["label"]),"view"===j.mode?(i(),d(V,{key:1,label:e.$t("创建时间"),prop:"createdTime"},{default:r((()=>[m(y,{modelValue:j.form.createdTime,"onUpdate:modelValue":l[6]||(l[6]=e=>j.form.createdTime=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):p("",!0),"view"===j.mode?(i(),d(V,{key:2,label:e.$t("修改时间"),prop:"modifiedTime"},{default:r((()=>[m(y,{modelValue:j.form.modifiedTime,"onUpdate:modelValue":l[7]||(l[7]=e=>j.form.modifiedTime=e),clearable:""},null,8,["modelValue"])])),_:1},8,["label"])):p("",!0)])),_:1},8,["label"]),"view"===j.mode?(i(),d(O,{key:0,label:e.$t("原始数据")},{default:r((()=>[m(k,{"expand-depth":5,theme:this.$TOOL.data.get("APP_SET_DARK")||this.$CONFIG.APP_SET_DARK?"dark":"light",value:j.form,copyable:"",expanded:"",sort:""},null,8,["theme","value"])])),_:1},8,["label"])):p("",!0)])),_:1})])),_:1},8,["disabled","model","rules"])),[[S,j.loading]])])),_:1},8,["modelValue","title"])}]]);export{v as default};
