import{_ as e}from"./index-Bx7rElEd.js";import{aj as t,o as s,c as i,S as o,R as r,a7 as n,J as a,K as l,P as u,Q as h,O as c,a as p,F as m,M as d}from"./@vue-_BCsYqm-.js";import"./element-plus-CoQd9HEf.js";import"./lodash-es-DCh--ulG.js";import"./@vueuse-DKZ1O7gq.js";import"./@element-plus-DpD46RjY.js";import"./@sxzz-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Cud5yAXI.js";import"./async-validator-BTKOuuO-.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-Vn5vHDCm.js";import"./@floating-ui-DT7V1Oc1.js";import"./crypto-js-BfYQ37JU.js";import"./axios-DMXdiZgf.js";import"./vue-router-DP39kmEB.js";import"./nprogress-BX4rmQ7W.js";import"./vuex-CNGLPxA3.js";import"./json-bigint-D0bu8vFr.js";import"./bignumber.js-iDjSUVmj.js";import"./vue-i18n-DbMEmpqT.js";import"./@intlify-CZIS8eQd.js";import"./vue3-json-viewer-B-aZDOpp.js";import"./ace-builds-D9YH2WY7.js";import"./vue3-ace-editor-ubj-WOyx.js";import"./resize-observer-polyfill-CzGuHLZU.js";import"./sortablejs-BALiOaUQ.js";import"./vkbeautify-DEVEMlla.js";const y={class:"sc-search"},f={key:0,class:"sc-search-history"},j={class:"sc-search-result"},v={key:0,class:"sc-search-no-result"},C={key:1},b=["onClick"],g={class:"title"};const k=e({data:()=>({cursor:{index:0},input:"",menu:[],result:[],history:[]}),watch:{result(){this.cursor.index=0}},async mounted(){this.history=this.$TOOL.data.get("SEARCH_HISTORY")||[],this.filterMenu(this.$GLOBAL.menu),await this.$nextTick(),await new Promise((e=>setTimeout(e,200))),this.$refs.input.focus()},methods:{inputKeyDown(e){var t,s,i;if(13!==e.keyCode)return 40===e.keyCode?(this.cursor.index=++this.cursor.index%this.result.length,void e.preventDefault()):void(38===e.keyCode&&(this.cursor.index=--this.cursor.index%this.result.length,this.cursor.index<0&&(this.cursor.index+=this.result.length),e.preventDefault()));null==(i=null==(s=null==(t=document.getElementsByClassName("sc-search-result")[0])?void 0:t.getElementsByClassName("el-scrollbar__view")[0])?void 0:s.children[this.cursor.index])||i.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))},inputChange(e){this.result=e?this.menuFilter(e):[]},filterMenu(e){e.forEach((e=>{if(e.meta.hidden||"button"===e.meta.type)return!1;"iframe"===e.meta.type&&(e.path=`/i/${e.name}`),e.children&&e.children.length>0&&!e.component?this.filterMenu(e.children):this.menu.push(e)}))},menuFilter(e){const t=[],s=this.menu.filter((t=>t.meta.title.toLowerCase().indexOf(e.toLowerCase())>=0||(t.name.toLowerCase().indexOf(e.toLowerCase())>=0||void 0))),i=this.$router.getRoutes();return s.map((e=>"link"===e.meta.type?i.find((t=>t.path==="/"+e.path)):i.find((t=>t.path===e.path)))).forEach((e=>{t.push({name:e.name,type:e.meta.type,path:"link"===e.meta.type?e.path.slice(1):e.path,icon:e.meta.icon,title:e.meta.title,breadcrumb:e.meta.breadcrumb.map((e=>e.meta.title)).join(" - ")})})),t},to(e){this.history.includes(this.input)||(this.history.push(this.input),this.$TOOL.data.set("SEARCH_HISTORY",this.history)),"link"===e.type?setTimeout((()=>{let t=document.createElement("a");t.style.display="none",t.target="_blank",t.href=e.path,document.body.appendChild(t),t.click(),document.body.removeChild(t)}),10):this.$router.push({path:e.path}),this.$emit("success",!0)},historyClick(e){this.input=e,this.inputChange(e)},historyClose(e){this.history.splice(e,1),this.history.length<=0?this.$TOOL.data.remove("SEARCH_HISTORY"):this.$TOOL.data.set("SEARCH_HISTORY",this.history)}}},[["render",function(e,k,x,w,O,$){const _=t("el-input"),E=t("el-tag"),T=t("el-icon"),L=t("el-scrollbar");return s(),i("div",y,[o(_,{modelValue:O.input,"onUpdate:modelValue":k[0]||(k[0]=e=>O.input=e),placeholder:e.$t("搜索"),"trigger-on-focus":!1,onInput:$.inputChange,onKeydown:$.inputKeyDown,autofocus:"",clearable:"","prefix-icon":"el-icon-search",ref:"input",size:"large"},null,8,["modelValue","placeholder","onInput","onKeydown"]),O.history.length>0?(s(),i("div",f,[(s(!0),i(r,null,n(O.history,((e,t)=>(s(),a(E,{key:e,onClick:t=>$.historyClick(e),onClose:e=>$.historyClose(t),closable:"",effect:"dark",type:"info"},{default:l((()=>[u(h(e),1)])),_:2},1032,["onClick","onClose"])))),128))])):c("",!0),p("div",j,[O.result.length<=0?(s(),i("div",v,h(e.$t("暂无搜索结果")),1)):(s(),i("ul",C,[o(L,{"max-height":"30rem"},{default:l((()=>[(s(!0),i(r,null,n(O.result,((e,t)=>(s(),i("li",{class:m({"sc-search-result-li-hover":this.cursor.index===t}),key:e.path,onClick:t=>$.to(e)},[o(T,null,{default:l((()=>[(s(),a(d(e.icon||"el-icon-menu")))])),_:2},1024),p("span",g,h(e.breadcrumb),1)],10,b)))),128))])),_:1})]))])])}],["__scopeId","data-v-01b47303"]]);export{k as default};
